// This file defines boilerplate code that forms part of every
// generated Go file.

package main

// header is included at the top of every generated Go file.
var header = `// This file was generated by gosp2go.

package main

import (
	gospJson "encoding/json"
	gospFlag "flag"
	gospFmt "fmt"
	gospOs "os"
)

`

// trailer is included at the end of every generated Go file.
var trailer = `
type GospRequest struct {
	Hostname  string
	QueryArgs string
	PathInfo  string
	Uri       string
	UserAgent struct {
		Hostname string
		Port     int
		IP       string
	}
}

func GospRequestFromFile(fn string) (*GospRequest, error) {
	f, err := gospOs.Open(fn)
	if err != nil {
		return nil, err
	}
	defer f.Close()
	dec := gospJson.NewDecoder(f)
	var gr GospRequest
	err = dec.Decode(&gr)
	if err != nil {
		return nil, err
	}
	return &gr, nil
}

var GospReq *GospRequest

func main() {
	file := gospFlag.String("file", "", "File name from which to read JSON code")
	gospFlag.Parse()
	if *file != "" {
		var err error
		GospReq, err = GospRequestFromFile(*file)
		if err != nil {
			panic(err)
		}
	}
	gospGenerateHTML()
}
`
